import{T as C}from"./index.6f5dada4.js";import{d as T,L as S,k as y,_ as k,r as u,o as s,x as f,w as o,b as n,c as D,z as E,f as F,t as w,F as $,j as L,A,a as I,B as N,y as B,H as U,I as q,E as G}from"./index.f1bf0a60.js";import{u as P}from"./sshinfo.0afb0940.js";import{g as O}from"./remote.a2c9b65a.js";const V=[{value:!0,label:"\u662F"},{value:!1,label:"\u5426"}],j=T({components:{Layer:S},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,l){const d=y(null),g=y(null);let c=y({id:"",ip:"",username:"",isadmin:!1,conn:[]});const h={username:[{required:!0,message:"\u7528\u6237\u540D",trigger:"blur"}],ip:[{required:!0,message:"\u7528\u6237\u8BBF\u95EEIP",trigger:"blur"}],isadmin:[{required:!0,message:"\u662F\u5426\u662Fadmin",trigger:"blur"}],conn:[{required:!1,message:"\u6388\u6743\u8BBF\u95EE\u7684\u670D\u52A1",trigger:"blur"}]};t();function t(){if(e.layer.row){c.value=JSON.parse(JSON.stringify(e.layer.row));const i=V.find(_=>_.label===e.layer.row.isadmin);i?c.value.isadmin=i.value:c.value.isadmin;let b=[];e.layer.row.conn.forEach(_=>{b.push(_.ID)})}}const r=y([]);function m(){O().then(i=>{r.value=i.data})}return m(),{radioData:V,connSelectData:r,form:c,rules:h,layerDom:g,ruleForm:d}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let l=this.form;this.layer.row&&this.updateForm(l)}else return!1})},updateForm(e){console.log(e),P(e).then(l=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData"),this.layerDom&&this.layerDom.close()})}}});function z(e,l,d,g,c,h){const t=u("el-input"),r=u("el-form-item"),m=u("el-radio"),i=u("el-radio-group"),b=u("el-option"),_=u("el-select"),v=u("el-form"),p=u("Layer",!0);return s(),f(p,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:o(()=>[n(v,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"130px",style:{"margin-right":"30px"}},{default:o(()=>[n(r,{label:"\u7528\u6237\u540D: ",prop:"username"},{default:o(()=>[n(t,{modelValue:e.form.username,"onUpdate:modelValue":l[0]||(l[0]=a=>e.form.username=a),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),n(r,{label:"\u7528\u6237\u8BBF\u95EEIP: ",prop:"ip"},{default:o(()=>[n(t,{modelValue:e.form.ip,"onUpdate:modelValue":l[1]||(l[1]=a=>e.form.ip=a),placeholder:"\u7528\u6237\u8BBF\u95EEIP",disabled:""},null,8,["modelValue"])]),_:1}),n(r,{label:"\u662F\u5426\u662Fadmin: ",prop:"isadmin"},{default:o(()=>[n(i,{modelValue:e.form.isadmin,"onUpdate:modelValue":l[2]||(l[2]=a=>e.form.isadmin=a)},{default:o(()=>[(s(!0),D($,null,E(e.radioData,a=>(s(),f(m,{key:a.value,label:a.value},{default:o(()=>[F(w(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(r,{label:"\u6388\u6743\u8BBF\u95EE\u7684\u670D\u52A1\uFF1A",prop:"connSelectData"},{default:o(()=>[n(_,{modelValue:e.form.conn,"onUpdate:modelValue":l[3]||(l[3]=a=>e.form.conn=a),placeholder:"\u8BF7\u9009\u62E9",clearable:"",multiple:""},{default:o(()=>[(s(!0),D($,null,E(e.connSelectData,a=>(s(),f(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var J=k(j,[["render",z]]);const H=T({name:"sshinfo",components:{Table:C,Layer:J},setup(){const e=y(!0),l=y([]),d=L({show:!1,title:"\u65B0\u589E",showButton:!0}),g=()=>{e.value=!0,U().then(t=>{let r=t.data;Array.isArray(r)&&r.forEach(m=>{const i=V.find(b=>b.value===m.isadmin);i?m.isadmin=i.label:m.isadmin}),l.value=r}).catch(()=>{l.value=[]}).finally(()=>{e.value=!1})},c=t=>{q({id:t}).then(r=>{G({type:"success",message:"\u5220\u9664\u6210\u529F"})})},h=t=>{d.title="\u7F16\u8F91\u6570\u636E",d.row=t,d.show=!0};return g(),{tableData:l,loading:e,layer:d,handleDel:c,handleEdit:h,getTableData:g}}}),M={class:"layout-container"},R={class:"layout-container-table"},K=F("\u66F4\u65B0");function Q(e,l,d,g,c,h){const t=u("el-table-column"),r=u("el-tag"),m=u("el-button"),i=u("el-popconfirm"),b=u("Table"),_=u("Layer"),v=A("loading");return s(),D("div",M,[I("div",R,[N((s(),f(b,{ref:"table",data:e.tableData,onGetTableData:e.getTableData},{default:o(()=>[n(t,{prop:"username",label:"\u7528\u6237\u540D",align:"center"}),n(t,{prop:"ip",label:"\u7528\u6237\u8BBF\u95EEIP",align:"center"}),n(t,{prop:"isadmin",label:"\u662F\u5426\u662Fadmin",align:"center"}),n(t,{prop:"conn",label:"\u6388\u6743\u8BBF\u95EE\u7684\u670D\u52A1",align:"center"},{default:o(p=>[(s(!0),D($,null,E(p.row.conn,a=>(s(),f(r,{key:a.ID,size:"small",type:"success",style:{margin:"1px"}},{default:o(()=>[F(w(a.Svcname),1)]),_:2},1024))),128))]),_:1}),n(t,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"200"},{default:o(p=>[p.row.username!=="root"?(s(),f(m,{key:0,onClick:a=>e.handleEdit(p.row)},{default:o(()=>[K]),_:2},1032,["onClick"])):B("",!0),n(i,{title:e.$t("message.common.delTip"),onConfirm:a=>e.handleDel(p.row.id)},{reference:o(()=>[p.row.username!=="root"?(s(),f(m,{key:0,type:"danger"},{default:o(()=>[F(w(e.$t("message.common.del")),1)]),_:1})):B("",!0)]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data","onGetTableData"])),[[v,e.loading]]),e.layer.show?(s(),f(_,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):B("",!0)])])}var x=k(H,[["render",Q]]);export{x as default};
