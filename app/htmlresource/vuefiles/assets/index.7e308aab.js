import{T as $}from"./index.a78fe6e0.js";import{q as v,d as F,L as C,k as m,v as S,_ as g,r as o,o as c,x as y,w as n,b as r,y as E,c as B,z as L,F as T,j as k,A,a as b,B as V,f as w}from"./index.4af6ff06.js";import{g as N}from"./remote.42c59c8f.js";import{P,S as G,D as I}from"./Search.baaf2765.js";function O(){return v({url:"/sshtunnel/list",method:"get"})}function j(e){return v({url:"/sshtunnel/add",method:"post",data:e})}function J(e){return v({url:"/sshtunnel/del",method:"post",data:e})}const U=F({components:{Layer:C},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})},data:{type:Array,default:[]}},setup(e,t){const a=m(null),d=m(null);let i=m({Local:"",Svcname:"",ID:""});const f={};l();function l(){e.layer.row&&(i.value=JSON.parse(JSON.stringify(e.layer.row)))}const s=m([]);function p(){N().then(h=>{s.value=h.data})}return p(),{BDP:S(()=>!!i.value.Local),selectData:s,form:i,rules:f,layerDom:d,ruleForm:a}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let t=this.form;if(this.layer.row)this.delForm({svcname:t.ID});else{let a=this.pd(t.Svcname);console.log("select: ",a),a?this.addForm(t):(this.$message({type:"success",message:"\u4F60\u5DF2\u7528\u6237\u8BE5\u670D\u52A1\u7684\u8BBF\u95EE\u6743\u9650"}),this.layer.show=!1)}}else return!1})},addForm(e){j(e).then(t=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData"),this.layerDom&&this.layerDom.close()})},delForm(e){J(e).then(t=>{this.$message({type:"success",message:"\u5220\u9664\u6210\u529F"}),this.$emit("getTableData"),this.layerDom&&this.layerDom.close()})},pd(e){let t=1;return this.data.forEach(a=>{a.ID===e&&(t=0)}),t===1}}});function q(e,t,a,d,i,f){const l=o("el-input"),s=o("el-form-item"),p=o("el-option"),_=o("el-select"),h=o("el-form"),D=o("Layer",!0);return c(),y(D,{layer:e.layer,data:e.data,onConfirm:e.submit,ref:"layerDom"},{default:n(()=>[r(h,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:n(()=>[e.BDP?(c(),y(s,{key:0,label:"\u672C\u5730\u8BBF\u95EE\u7AEF\u53E3: ",prop:"Host"},{default:n(()=>[r(l,{modelValue:e.form.Local,"onUpdate:modelValue":t[0]||(t[0]=u=>e.form.Local=u)},null,8,["modelValue"])]),_:1})):E("",!0),r(s,{label:"\u8FDC\u7AEF\u670D\u52A1\uFF1A",prop:"Svcname"},{default:n(()=>[r(_,{modelValue:e.form.Svcname,"onUpdate:modelValue":t[1]||(t[1]=u=>e.form.Svcname=u),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:n(()=>[(c(!0),B(T,null,L(e.selectData,u=>(c(),y(p,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","data","onConfirm"])}var z=g(U,[["render",q]]);const H=F({name:"sshinfo",components:{Table:$,Layer:z},setup(){const e=m(!0),t=m([]),a=k({show:!1,title:"\u65B0\u589E",showButton:!0}),d=()=>{e.value=!0,O().then(l=>{t.value=l.data}).catch(()=>{t.value=[]}).finally(()=>{e.value=!1})},i=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},f=l=>{a.title="\u5220\u9664\u6570\u636E",a.row=l,a.show=!0};return d(),{Plus:P,Search:G,Delete:I,tableData:t,loading:e,layer:a,handleAdd:i,handleEdit:f,getTableData:d}}}),R={class:"layout-container"},K={class:"layout-container-form flex space-between"},M={class:"layout-container-form-handle"},Q=w("\u7533\u8BF7\u65B0\u7684\u8BBF\u95EE"),W={class:"layout-container-table"},X=w("\u5220\u9664");function Y(e,t,a,d,i,f){const l=o("el-button"),s=o("el-table-column"),p=o("Table"),_=o("Layer"),h=A("loading");return c(),B("div",R,[b("div",K,[b("div",M,[r(l,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:n(()=>[Q]),_:1},8,["icon","onClick"])])]),b("div",W,[V((c(),y(p,{ref:"table",data:e.tableData,onGetTableData:e.getTableData},{default:n(()=>[r(s,{prop:"Local",label:"\u5185\u90E8\u8BBF\u95EE\u7AEF\u53E3",align:"center"}),r(s,{prop:"Svcname",label:"\u8FDC\u7AEF\u670D\u52A1",align:"center"}),r(s,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"200"},{default:n(D=>[r(l,{onClick:u=>e.handleEdit(D.row)},{default:n(()=>[X]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onGetTableData"])),[[h,e.loading]]),e.layer.show?(c(),y(_,{key:0,layer:e.layer,data:e.tableData,onGetTableData:e.getTableData},null,8,["layer","data","onGetTableData"])):E("",!0)])])}var ae=g(H,[["render",Y]]);export{ae as default};
